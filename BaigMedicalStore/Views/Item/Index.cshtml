
@using Kendo.Mvc.UI
@using BaigMedicalStore.Common

@model IEnumerable<BaigMedicalStore.Models.ItemViewModel>

@{
    ViewBag.Title = "Items";

    var actionColumnTemplate = string.Empty;
    var baseEditActionUrl = CommonFunction.GetBaseUrlForActions("Edit", "Item");
    actionColumnTemplate += "<a href=" + baseEditActionUrl + "#: EditItemUrl # >";
    actionColumnTemplate += "<span class='icon-grid icon-edit'></span></a>";

    var statusColumnTemplate = string.Empty;
    statusColumnTemplate += "<a class='seleclink' onclick='ItemGridManager.onChangeItemStatus(this, #=ItemId#)'>";
    statusColumnTemplate += "#=Status# </a> ";

    var stockStatusColumnTemplate = "#if (TotalStock <= LimitNotification) {  #<span  style ='color: red; font-weight: 900;font-size: xx-large; ' title = ''>#=TotalStock#</span># } else { #<span style =' font-weight: 900;font-size: xx-large;' title = '' >#=TotalStock#</span>#} #";


    var barCodeColumnTemplate = string.Empty;
    barCodeColumnTemplate += "<img src='#: imgbarCode #' >";

}

<div class="page-heading">
    @ViewBag.Title 
</div>
<div class="search-panel">
    <div class="col-md-12 p0">
        <div class="search-panel-input-bar">
            <div class="col-md-3 pl0">
                <div class="search-panel-input">
                    <label class="col-md-6 p0">Name</label>
                    <input type="text" id="txtName" placeholder="Search By Name" class="form-control" data-field="Name" />
                </div>
            </div>
            <div class="col-md-3 pl0">
                <div class="search-panel-input">
                    <label class="col-md-6 p0">Code</label>
                    <input type="text" id="txtCode" placeholder="Search By Code" class="form-control" data-field="Code" />
                </div>
            </div>

            <div class="col-md-3 pl0">
                <div class="search-panel-input">
                    <label class="col-md-6 p0">Location</label>
                    <input type="text" id="txtLocation" placeholder="Search By Location" class="form-control" data-field="Location" />
                </div>
            </div> 
        </div>
    </div>
    <div class="col-md-12 p0">
        <div class="search-panel-button-bar floatr m0">
            <input type="button" value="SEARCH" id="btnSearch" class="btn btn-kips btn-purple mt0" />
            <input type="button" value="RESET" id="btnReset" class="btn btn-kips mtr0" />
        </div>
    </div>
    <div class="clearfix"></div>
</div>


<div class="grid-top-button-bar">

    @Html.ActionLink("Add Item", "Add", "Item", null, new { @class = "btn btn-kips btn-large" })

</div>

<br />

<div>
    @(Html.Kendo().Grid(Model)
          .Name("ItemGrid")
          .Columns(columns =>
          {
              columns.Bound(s => s.ItemId).Title("ItemId").Hidden();
              columns.Bound(s => s.Name).Title("Name").HeaderHtmlAttributes(new { title = "Name" });
              columns.Bound(s => s.Code).Title("Code").HeaderHtmlAttributes(new { title = "Code" });
              columns.Bound(s => s.PiecesInPaking).Title("Pieces/Paking").HeaderHtmlAttributes(new { title = "Pieces / Paking" });
              columns.Bound(s => s.UnitPrice).Title("UnitPrice").HeaderHtmlAttributes(new { title = "UnitPrice" });
              columns.Bound(s => s.LocationName).Title("Location").HeaderHtmlAttributes(new { title = "Location" });
             // columns.Bound(s => s.TotalStock).Title("TotalStock").HeaderHtmlAttributes(new { title = "TotalStock" }).Sortable(false);
                columns.Bound(s => s.TotalStock).Title("").Filterable(f => f.Enabled(false)).ClientTemplate(stockStatusColumnTemplate).Width(100).Title("TotalStock").Sortable(false);
              columns.Bound(s => s.ItemId).Title("").Filterable(f => f.Enabled(false)).ClientTemplate(actionColumnTemplate).Width(100).Title("Action").Sortable(false);

          })
          .Pageable(pageable => pageable.ButtonCount(10).PageSizes(new int[] { 20, 30, 40, 50, 100, 200 }))
          .Selectable(selectable => selectable.Mode(GridSelectionMode.Single))
          .Sortable()
          .DataSource(dataSource => dataSource
              .Ajax()
              .PageSize(50)
              .Model(model => model.Id(s => s.ItemId))
              .Read(read => read.Action("GetItems", "Item"))
              .Events(e =>
              {
                  e.Error("BMS.SiteScript.KendoEventHandler.onGridError");
              })
          ).Events(e => e.DataBound("BMS.SiteScript.KendoEventHandler.onGridDataBound"))

    )
</div>

@section scripts
{
    @Scripts.Render("~/bundles/ItemGridManager")
}
